(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabs/tab2"],{"12db":function(e,t,o){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(o("f691")),s=u(o("b5ea"));u(o("eb61"));function u(e){return e&&e.__esModule?e:{default:e}}var r=function(){return o.e("components/loading").then(o.bind(null,"8bed"))},l=function(){return o.e("components/search").then(o.bind(null,"cda8"))},d=function(){return Promise.all([o.e("common/vendor"),o.e("components/header")]).then(o.bind(null,"0117"))},i={data:function(){return{page:1,size:24,books:[],showTips:!1,wd:"",token:"",showLongpressTips:!1}},components:{search:l,loading:r,iheader:d},onShow:function(){this.showLongpressTips="false"!=e.getStorageSync("showLongpressTips");var t=s.default.getSysInfo();n.default.debug&&a("log","onShow","bookshelfChanged",t.bookshelfChanged," at pages/tabs/tab2.vue:51"),this.loadBooks(t.bookshelfChanged),t.bookshelfChanged=!1,s.default.setSysInfo(t)},onReachBottom:function(){this.loadBooks()},methods:{onClickRight:function(){a("log","订单add"," at pages/tabs/tab2.vue:61")},longpress:function(t){n.default.debug&&a("log","longpress",t," at pages/tabs/tab2.vue:64");var o=this,u=t.currentTarget.dataset.book,r=t.currentTarget.dataset.id,l=o.books;e.showModal({title:"温馨提示",content:"您是否要将书籍《".concat(u,"》从书架中移除？"),success:function(t){t.confirm&&(n.default.debug&&a("log","确定移除"," at pages/tabs/tab2.vue:74"),s.default.request(n.default.api.bookStar,{identify:r}).then(function(t){n.default.debug&&a("log",n.default.api.bookStar,t," at pages/tabs/tab2.vue:78"),e.showToast({title:t.data.data&&t.data.data.is_cancel?"移除收藏成功":"收藏书籍成功"}),o.books=l.filter(function(e){return e.book_id!=r})}).catch(function(e){s.default.toastError(e.data.message||e.errMsg)}))}})},closeLongpressTips:function(){this.showLongpressTips=!1,e.setStorageSync("showLongpressTips","false")},loadBooks:function(t){var o=this,u=s.default.getToken()||"";if(n.default.debug&&a("log","token",u," at pages/tabs/tab2.vue:102"),""==u)return o.showTips=!0,o.books=[],o.token=u,void(o.page=1);if(0!=o.page||t){var r=t?1:o.page,l=o.size,d=o.books;s.default.request(n.default.api.bookshelf,{page:r,size:l}).then(function(e){n.default.debug&&a("log",n.default.api.bookshelf,e," at pages/tabs/tab2.vue:123"),e.data&&e.data.books?(e.data.books.length>=l?r++:r=0,d=t?e.data.books:o.books.concat(e.data.books)):(1==r&&(d=[],!0),r=0)}).catch(function(e){n.default.debug&&a("log","error",e," at pages/tabs/tab2.vue:136"),s.default.toastError(e.data.message||e.errMsg)}).finally(function(){o.books=d,o.showTips=0==d.length,o.page=r,o.token=u,t&&e.pageScrollTo({scrollTop:0})})}},login:function(t){e.navigateTo({url:"/pages/login/login?redirect="+encodeURIComponent("/pages/bookshelf/bookshelf")})}}};t.default=i}).call(this,o("6e42")["default"],o("0de9")["default"])},"23bb":function(e,t,o){"use strict";(function(e){o("0007"),o("921b");a(o("66fd"));var t=a(o("d1af"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])},"2ee3":function(e,t,o){"use strict";var a=o("b1d9"),n=o.n(a);n.a},9138:function(e,t,o){"use strict";var a={"hx-navbar":()=>o.e("components/hx-navbar/hx-navbar").then(o.bind(null,"670c"))},n=function(){var e=this,t=e.$createElement;e._self._c},s=[];o.d(t,"b",function(){return n}),o.d(t,"c",function(){return s}),o.d(t,"a",function(){return a})},b1d9:function(e,t,o){},d1af:function(e,t,o){"use strict";o.r(t);var a=o("9138"),n=o("eed0");for(var s in n)"default"!==s&&function(e){o.d(t,e,function(){return n[e]})}(s);o("2ee3");var u,r=o("f0c5"),l=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],u);t["default"]=l.exports},eed0:function(e,t,o){"use strict";o.r(t);var a=o("12db"),n=o.n(a);for(var s in a)"default"!==s&&function(e){o.d(t,e,function(){return a[e]})}(s);t["default"]=n.a}},[["23bb","common/runtime","common/vendor"]]]);